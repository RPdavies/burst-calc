{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Analyze bursts\"\noutput: html_notebook\n---\n\nDemonstrates burst analysis on a sample data from a simple burster (modified Poisson process): an ON-OFF switch with events firing in the ON state. Transition rates are kON = kOFF = 0.1 [1/T], kProd = 10 [1/T]. Thus, on average, there are 100 events per ON state. The ON and OFF states last, on average, 10 time units each.\n\n```{r}\nrequire(ggplot2)\nrequire(dplyr)\nsource('auxfn.R')\nsource('calcBurstSzFn.R')\n\n# read example data\ndf = read.csv('../example-data-1/output1.prel', header = F)\n\n# calculate burst size function\ndf.phi=calcBurstSzFn(df$V1, 100, 1/2)\n\n```\n\n## Plot of burst size function.\n\n```{r}\nggplot(df.phi, aes(x=t, y=b)) +\n  geom_line() +\n  xlab(\"\\nthreshold length [T]\") +\n  ylab(\"burst size\\n\") +\n  myGGtheme\n\n```\n\n## Burst size \nCalculated at taux, which lies in the middle between two inflection points, tau1 and tau2:\n\n```{r}\ntx = 0.8\nf.inter = function(x) splinefun(df.phi$t, df.phi$b, method='monoH.FC')(x)\nf.inter(tx)\n\n```\n\n## Burst significance\n\nFormula: 1 - tau2/tau1. Requires calculation of two inflection points of the burst size function. Here, we assume that tau2 is at tau=1.5 and tau1 at tau=0.5.\n\n```{r}\n1 - f.inter(0.5)/f.inter(1.5)\n```\n\n\n## Burst duration\nτβ, is the mean inter-arrival time within a burst. Calculate by averaging over intervals lower than τX.\n\n```{r}\nv.sub = df$V1[df$V1 > 0 & df$V1 < tx]\nmean(v.sub)\n```\n\n## Burstiness\nSee definition in https://arxiv.org/pdf/1604.01125.pdf\n\nB has the value of −1 for regular time series as σ = 0, and 0 for Poissonian or random time series as σ = μ. Finally, the value of B approaches 1 for extremely bursty time series as σ → ∞ for finite μ. \n\n```{r}\n(sd(df$V1) - mean(df$V1))/(sd(df$V1) + mean(df$V1))\n```\n\n",
    "created" : 1522364156240.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2930266632",
    "id" : "55ECA5F3",
    "lastKnownWriteTime" : 1522364505,
    "last_content_update" : 1522364505940,
    "path" : "~/Dropbox/Projects/scripts/burst-calc/R/analyzeBursts.Rmd",
    "project_path" : "analyzeBursts.Rmd",
    "properties" : {
        "chunk_output_type" : "inline",
        "docOutlineVisible" : "0"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}